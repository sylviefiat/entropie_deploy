# UMR ENTROPIE WEBSITE
entropiedb:
  hostname: entropiedb
  image: centurylink/mysql
  volumes:
    - ./mysql_data:/var/lib/mysql
  ports:
    - "3306:3306"
  environment:
    - MYSQL_DATABASE=concrete
    - MYSQL_USERNAME=docker
    - MYSQL_PASSWORD=docker
    - MYSQL_ROOT_PASSWORD=docker

entropie:
  hostname: entropie
  image: sylviefiat/docker-concrete5.7
  ports:
    - "81:80"
  environment:
    - DB_USER=root
    - DB_PASS=docker
    - DB_HOST=mysql
    - DB_NAME=concrete
  volumes:
    - ./concrete5_data/application:/app/application
    - ./concrete5_data/packages:/app/packages
    - ./concrete5_data/updates:/app/updates
  links:
    - entropiedb:entropiedb

entropiegis:
  image: sylviefiat/geoserver
  command: "/opt/geoserver/bin/startup.sh"
  hostname: entropiegis
  volumes:
    - ./geoserver_data:/opt/geoserver/data_dir
  ports:
    - "8081:8080"
  links:
    - entropiedb:entropiedb

# OREANET NEW CALEDONIA WEBSITE
oreanetdb:
  hostname: oreanetdb
  image: centurylink/mysql
  volumes:
    - ./oreanetdb_data:/var/lib/mysql
  ports:
    - "3307:3306"
  environment:
    - MYSQL_DATABASE=oreanet
    - MYSQL_USERNAME=docker
    - MYSQL_PASSWORD=docker
    - MYSQL_ROOT_PASSWORD=docker

oreanetgis:
  image: sylviefiat/geoserver
  command: "/opt/geoserver/bin/startup.sh"
  hostname: oreanetgis
  volumes:
    - ./geoserver_data:/opt/geoserver/data_dir
  ports:
    - "8082:8080"
  links:
    - oreanetdb:oreanetdb

oreanet:
  image: sylviefiat/joomla-cot
  command: /run.sh
  hostname: oreanet
  ports:
    - 82:80
  volumes:
    - ./joomla_data/templates:/app/templates
    - ./joomla_data/tmp:/app/tmp
    - ./joomla_data/images:/app/images
  links:
    - oreanetdb:oreanetdb
    - oreanetgs:oreanetgs

# PROXY ROUTER FOR DOCKER
redis:
  image: tutum.co/sylviefiat/redis
  command: /start-redis.sh
  hostname: redis
  environment:
    - IRD_EXT=ird.nc
  volumes:
    - ./redis_data:/data

hipache:
  image: sylviefiat/docker-hipache
  hostname: hipache
  ports:
    - "80:80"
  links:
    - entropie:entropie
    - entropiegis:entropiegis
    - oreanetgis:oreanetgis
    - oreanet:oreanet
    - redis:redis
